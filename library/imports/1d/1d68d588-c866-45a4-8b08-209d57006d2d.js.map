{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        physicalNodes: {\r\n            default: [],\r\n            type: [cc.Node]\r\n        },\r\n        \r\n        countDownLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        \r\n        coinLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        \r\n        maxPhysical: 5,\r\n        chargePhysicalTime: 600,\r\n    },\r\n\r\n    onLoad: function () {\r\n        this._uiManager = this.node.getComponent('ui_manager');\r\n        this._physicalPoints = [];\r\n        for (var i = 0; i < this.physicalNodes.length; i++) {\r\n            var node = this.physicalNodes[i];\r\n            this._physicalPoints.push(node.getComponent('physical_point'));\r\n        }\r\n        \r\n        this._countDownTime = 0;\r\n        this.updateCountDown();\r\n        \r\n        this._physical = 0;\r\n        this.updatePhysical();\r\n        \r\n        this._countting = false;\r\n        \r\n        this._onCountDown = function () {\r\n            this.onCountDown();\r\n        }\r\n        \r\n        this._startHandler = Global.gameEventDispatcher.addEventHandler(GameEvent.ON_START_GAME, this.onStartGame.bind(this));\r\n        this._getGameDataHandler = Global.gameEventDispatcher.addEventHandler(GameEvent.ON_GET_GAME_DATA, this.onGetGameData.bind(this));\r\n        this._exchangeHandler = Global.gameEventDispatcher.addEventHandler(GameEvent.ON_EXCHANGE_GOLD, this.onExchangeCoin.bind(this));\r\n        this._buyPhysicalHandler = Global.gameEventDispatcher.addEventHandler(GameEvent.ON_BUY_PHYSICAL, this.onBuyFullPhysical.bind(this));\r\n    \r\n        this.loadMusic();\r\n    },\r\n    \r\n    onDestroy: function () {\r\n        Global.gameEventDispatcher.removeEventHandler(this._startHandler);\r\n        Global.gameEventDispatcher.removeEventHandler(this._getGameDataHandler);\r\n        Global.gameEventDispatcher.removeEventHandler(this._exchangeHandler);\r\n        Global.gameEventDispatcher.removeEventHandler(this._buyPhysicalHandler);\r\n        this._buyPhysicalHandler = null;\r\n        this._getGameDataHandler = null;\r\n        this._exchangeHandler = null;\r\n        this._startHandler = null;\r\n        cc.audioEngine.stopMusic(true);\r\n    },\r\n    \r\n    start: function () {\r\n        GameRpc.Clt2Srv.getGameData();\r\n    },\r\n    \r\n    resetCountDown: function () {\r\n        this.stopCountDown();\r\n        if (this._physical < this.maxPhysical) {\r\n            this.countDownLabel.node.active = true;\r\n            this.startCountDown(Global.accountModule.nextPowerTime);\r\n        } else {\r\n            this.countDownLabel.node.active = false;\r\n        }\r\n    },\r\n    \r\n    startCountDown: function (time) {\r\n        if (this._countting)\r\n            return;\r\n        this._countting = true;\r\n        this._countDownTime = time;\r\n        this.updateCountDown();\r\n        this.schedule(this._onCountDown, 1);\r\n    },\r\n    \r\n    stopCountDown: function () {\r\n        if (!this._countting)\r\n            return;\r\n        this._countting = false;\r\n        this.unschedule(this._onCountDown);\r\n    },\r\n    \r\n    updateCountDown: function () {\r\n        this.countDownLabel.string = TimeUtil.secToMS(this._countDownTime);\r\n    },\r\n    \r\n    updatePhysical: function () {\r\n        var i = 0;\r\n        for (; i < this._physical; i++)\r\n            this._physicalPoints[i].state = 0;\r\n        for (; i < this.maxPhysical; i++)\r\n            this._physicalPoints[i].state = 1;\r\n    },\r\n\r\n    chargePhysical: function () {\r\n        if (this._physical >= this.maxPhysical)\r\n            return;\r\n        this._physical++;\r\n        this.updatePhysical();\r\n    },\r\n    \r\n    costPhysical: function () {\r\n        if (this._physical <= 0)\r\n            return false;\r\n        this._physical--;\r\n        this.updatePhysical();\r\n        return true;\r\n    },\r\n\r\n    loadMusic: function() {\r\n        var self = this;\r\n        cc.loader.loadRes(\"sound/game\", cc.AudioClip, function (err, audioClip) {\r\n            cc.audioEngine.playMusic(audioClip, true);\r\n        });\r\n    },\r\n    \r\n    onAddCoinButtonClick: function () {\r\n        GameUtil.playButtonSound();\r\n        this._uiManager.openUI('exchange_coin');\r\n    },\r\n    \r\n    onCountDown: function () {\r\n        this._countDownTime--;\r\n        if (this._countDownTime < 0)\r\n            this._countDownTime = 0;\r\n        if (this._countDownTime === 0) {\r\n            this.chargePhysical();\r\n            if (this._physical < this.maxPhysical) {\r\n                this._countDownTime = this.chargePhysicalTime;\r\n            } else {\r\n                this.stopCountDown();\r\n            }\r\n        }\r\n        this.updateCountDown();\r\n    },\r\n    \r\n    onBuyFullPhysical: function () {\r\n        this.coinLabel.string = Global.accountModule.goldNum;\r\n        this._physical = Global.accountModule.power;\r\n        this.updatePhysical();\r\n        this.resetCountDown();\r\n    },\r\n\r\n    onExchangeCoin: function () {\r\n        this.coinLabel.string = Global.accountModule.goldNum;\r\n    },\r\n\r\n    onGetGameData: function () {     \r\n        this.coinLabel.string = Global.accountModule.goldNum;\r\n        this._physical = Global.accountModule.power;\r\n        this.updatePhysical();\r\n        this.resetCountDown();\r\n    },\r\n\r\n    onStartGame: function () {\r\n        GameUtil.loadScene('battle');\r\n    },\r\n    \r\n    onPlayButtonClick: function () {\r\n        GameUtil.playButtonSound();\r\n        if (this.costPhysical()) {\r\n            this.stopCountDown();\r\n            GameRpc.Clt2Srv.startGame();\r\n        } else {\r\n            this._uiManager.openUI('physical_not_enough');\r\n        }\r\n    },\r\n    \r\n});\r\n"
  ]
}